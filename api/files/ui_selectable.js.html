<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ui\selectable.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    
	<link href="http://simpleui.org/wp-content/themes/simpleui/css/style.css" rel="stylesheet">
	<link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
<div class="navbar navbar-fixed-top">
     
        <div class="container navbar-inner">
            <h1 class="nav-title">
                <a href="http://simpleui.org/">Simple <span class="nav-title-em">UI</span></a>
				<p>Simple UI library for the web & make web build quickly</p>
            </h1>
           
           <!-- <div class="navbar-col" title="切换显示咧">
                <a class="navbar-col2-demo ib" title="两栏" rel="two" href="javascript:;">
                    
                </a>
                <a class="navbar-col3-demo ib" title="三栏" rel="three" href="javascript:;">
                    
                </a>
            </div> -->
            <div class="navbar-search">
                <form action="http://simpleui.org/" method="get" id="searchForm">
                        <input type="text" placeholder="请输入搜索的关键字" name="s"/><button type="submit"></button>
                </form>
                      
            </div>
        </div>
      
</div>
<div class="nav-menu-container">
 <ul class="nav-menu"><li id="menu-item-10" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10"><a href="http://simpleui.org/category/guides/">指南</a></li>
<li id="menu-item-11" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-11 current_page_item"><a href="http://simpleui.org/api">文档</a></li>
<li id="menu-item-51" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-51"><a href="http://simpleui.org/deploy">部署</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-50"><a href="http://github.com/WindyGex/SimpleUI">下载</a></li>
</ul> </div> 
	<div class="container">
    <div id="bd" class="yui3-g">
        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Simple.Attribute.html">Simple.Attribute</a></li>
            
                <li><a href="..&#x2F;classes/Simple.AutoComplete.html">Simple.AutoComplete</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Button.html">Simple.Button</a></li>
            
                <li><a href="..&#x2F;classes/Simple.ButtonGroup.html">Simple.ButtonGroup</a></li>
            
                <li><a href="..&#x2F;classes/Simple.ComboButton.html">Simple.ComboButton</a></li>
            
                <li><a href="..&#x2F;classes/Simple.ContextMenu.html">Simple.ContextMenu</a></li>
            
                <li><a href="..&#x2F;classes/Simple.DatePicker.html">Simple.DatePicker</a></li>
            
                <li><a href="..&#x2F;classes/Simple.DatePickerBase.html">Simple.DatePickerBase</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Dialog.html">Simple.Dialog</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Drag.html">Simple.Drag</a></li>
            
                <li><a href="..&#x2F;classes/Simple.DropDownButton.html">Simple.DropDownButton</a></li>
            
                <li><a href="..&#x2F;classes/Simple.EventTarget.html">Simple.EventTarget</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Menu.html">Simple.Menu</a></li>
            
                <li><a href="..&#x2F;classes/Simple.MenuItem.html">Simple.MenuItem</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Modal.html">Simple.Modal</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Pagination.html">Simple.Pagination</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Resize.html">Simple.Resize</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Selectable.html">Simple.Selectable</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Tip.html">Simple.Tip</a></li>
            
                <li><a href="..&#x2F;classes/Simple.TipBase.html">Simple.TipBase</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Transition.html">Simple.Transition</a></li>
            
                <li><a href="..&#x2F;classes/Simple.Widget.html">Simple.Widget</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/attribute.html">attribute</a></li>
            
                <li><a href="..&#x2F;modules/declare.html">declare</a></li>
            
                <li><a href="..&#x2F;modules/event.html">event</a></li>
            
                <li><a href="..&#x2F;modules/transition.html">transition</a></li>
            
                <li><a href="..&#x2F;modules/ui.auto-complete.html">ui.auto-complete</a></li>
            
                <li><a href="..&#x2F;modules/ui.button.html">ui.button</a></li>
            
                <li><a href="..&#x2F;modules/ui.button-group.html">ui.button-group</a></li>
            
                <li><a href="..&#x2F;modules/ui.date-picker.html">ui.date-picker</a></li>
            
                <li><a href="..&#x2F;modules/ui.dialog.html">ui.dialog</a></li>
            
                <li><a href="..&#x2F;modules/ui.drag.html">ui.drag</a></li>
            
                <li><a href="..&#x2F;modules/ui.menu.html">ui.menu</a></li>
            
                <li><a href="..&#x2F;modules/ui.modal.html">ui.modal</a></li>
            
                <li><a href="..&#x2F;modules/ui.pagination.html">ui.pagination</a></li>
            
                <li><a href="..&#x2F;modules/ui.resize.html">ui.resize</a></li>
            
                <li><a href="..&#x2F;modules/ui.selectable.html">ui.selectable</a></li>
            
                <li><a href="..&#x2F;modules/ui.tool-tip.html">ui.tool-tip</a></li>
            
                <li><a href="..&#x2F;modules/widget.html">widget</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ui\selectable.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
define([&#x27;simple&#x27;, &#x27;widget&#x27;, &#x27;declare&#x27;], function(S, Widget, declare){

    var $ = S.$, Selectable;
    
    &#x2F;**
     * 让一个dom元素可以被框选
     *     
     *     require([&#x27;ui&#x2F;selectable&#x27;],function(){
     *         $(&#x27;#test&#x27;).selectable({
     *             selectNode:&#x27;li&#x27;
     *         });
     *     });
     *     
     * @class Simple.Selectable
     * @module ui.selectable
     *&#x2F;
    Selectable = declare(&quot;Selectable&quot;, null, {
        &#x2F;**
         * 设置需要框选元素的父级容器
         * @property node
         * @type String | HTMLElement
         * @default &#x27;&#x27;
         *&#x2F;
        node: null,
        &#x2F;**
         * node元素中的子集节点，会被选中,应该是一个jQuery选择器
         * @property selectNode
         * @type String
         * @default &#x27;&#x27;
         *&#x2F;
        selectNode: null,
        &#x2F;**
         * 选中的元素加上的类，以表明该元素被选中了
         * @property selectCls
         * @type String
         * @default &#x27;simple-selectable&#x27;
         *&#x2F;
        selectCls: &#x27;simple-selectable&#x27;,
        &#x2F;**
         * 延迟触发selectable事件
         * @property delay
         * @type Int
         * @default 3
         *&#x2F;
        delay: 3,
        &#x2F;**
         * 框选开始时触发的事件
         * @property onSelectStart
         * @type Function
         * @default empty Function
         *&#x2F;
        onSelectStart: function(){
        
        },
        &#x2F;**
         * 框选结束时触发的事件
         * @property onSelectEnd
         * @type Function
         * @default empty Function
         *&#x2F;
        onSelectEnd: function(e, hasSelectNode){
        
        },
        init: function(){
            var self = this;
            $(this.node).mousedown(function(e){
                self._mouseDown.apply(self, [e]);
            });
        },
        &#x2F;**
         * 销毁框选特性
         * @method destroy
         *&#x2F;
        destroy:function(){
            $(this.node).off();
        },
        &#x2F;&#x2F;鼠标按下
        _mouseDown: function(e){
            var self = this;
            this.onSelectStart.apply(this.node, [e]);
            &#x2F;&#x2F;create div to show select area
            &#x2F;&#x2F;this._createSelectArea();
            this.lastX = e.pageX;
            this.lastY = e.pageY;
            this.hasNodeSelected = [];
            $(document).mousemove(function(e){
                self._mouseMove.apply(self, [e]);
            });
            $(document).mouseup(function(e){
                self._mouseUp.apply(self, [e]);
            });
            $(this.node).unselect();
            $(document.body).unselect();
        },
        _mouseMove: function(e){
            var pageX = e.pageX, pageY = e.pageY, addX = Math.abs(pageX - this.lastX), addY = Math.abs(pageY - this.lastY), self = this, selector;
            
            
            if (addX &gt; this.delay &amp;&amp; addY &gt; this.delay) {
                if (!this.selectProxy) {
                    this._createSelectArea(this.lastX, this.lastY);
                }
                &#x2F;&#x2F;更新选择范围的DIV的大小
                this.selectProxy.width(addX).height(addY);
                &#x2F;&#x2F;当改变的值为负值时，更新选中区域的left和top值
                if (pageX - this.lastX &lt; 0) {
                    this.selectProxy.css(&quot;left&quot;, e.pageX);
                }
                if (pageY - this.lastY &lt; 0) {
                    this.selectProxy.css(&quot;top&quot;, e.pageY);
                }
                &#x2F;&#x2F;判断是否与Node节点下的selectNode相交
                if (this.selectNode) {
                    selector = this.selectNode;
                }
                else {
                    selector = &quot;*&quot;;
                }
                $(this.node).find(selector).each(function(){
                    &#x2F;&#x2F;是否相交
                    if (self._isIntersect(this, self.selectProxy[0])) {
                        if ($(this).attr(&quot;y-selected&quot;) == 1) {
                        
                        }
                        else {
                            $(this).addClass(self.selectCls).attr(&quot;simpleselected&quot;, 1);
                        }
                    }
                    else {
                        $(this).removeClass(self.selectCls).attr(&quot;simpleselected&quot;, 0);
                    }
                });
                this.selectstart = true;
            }
        },
        _mouseUp: function(e){
            if (this.selectstart) {
                var self = this;
                &#x2F;&#x2F;移除创建的div
                if (this.selectProxy) {
                    this.selectProxy.remove();
                }
                var selectNode = self._getSelectedNode();
                &#x2F;&#x2F;触发选择结束事件
                self.onSelectEnd.apply(self.node, [e, selectNode]);
                
                this.selectProxy = null;
                this.selectstart = false;
            }
            &#x2F;&#x2F;解除事件绑定
            $(document).unbind(&quot;mousemove&quot;).unbind(&quot;mouseup&quot;);
            $(this.node).unselect(false);
            $(document.body).unselect(false);
        },
        _getSelectedNode: function(){
            return $(this.node).find(&#x27;[simpleselected=1]&#x27;);
        },
        &#x2F;&#x2F;创建一个DIV来显示选择的范围
        _createSelectArea: function(x, y){
            this.selectProxy = $(&quot;&lt;div&#x2F;&gt;&quot;).addClass(&quot;simple-selectable-proxy&quot;);
            this.selectProxy.css({
                left: x,
                top: y
            });
            this.selectProxy.appendTo(document.body);
        },
        _isIntersect: function(nodeA, nodeB){
            var nodeAOffset = $(nodeA).offset(), nodeBOffset = $(nodeB).offset(), nodeAWidth = $(nodeA).width(), nodeAHeight = $(nodeA).height(), nodeBWidth = $(nodeB).width(), nodeBHeight = $(nodeB).height();
            &#x2F;&#x2F;不相交的情况
            &#x2F;&#x2F;A top&gt; B bottom
            &#x2F;&#x2F;A bottom &lt; B top
            &#x2F;&#x2F;A right &lt; B left
            &#x2F;&#x2F;A left &gt;B right
            if (nodeAOffset.top &gt; nodeBOffset.top + nodeBHeight ||
            nodeAOffset.top + nodeAHeight &lt; nodeBOffset.top ||
            nodeAOffset.left + nodeAWidth &lt; nodeBOffset.left ||
            nodeAOffset.left &gt; nodeBOffset.left + nodeBWidth) {
                return false;
            }
            else {
                return true;
            }
        }
    });
    
    &#x2F;&#x2F;拖动的时候不要选中元素
    if (!$.fn.unselect) {
        $.fn.unselect = function(prevent){
            prevent = (prevent == null) ? true : prevent;
            if (prevent) {
                return this.each(function(){
                    if ($.browser.msie || $.browser.safari) 
                        $(this).bind(&#x27;selectstart&#x27;, function(){
                            return false;
                        });
                    else 
                        if ($.browser.mozilla) {
                            $(this).css(&#x27;MozUserSelect&#x27;, &#x27;none&#x27;);
                            $(&#x27;body&#x27;).trigger(&#x27;focus&#x27;);
                        }
                        else 
                            if ($.browser.opera) 
                                $(this).bind(&#x27;mousedown&#x27;, function(){
                                    return false;
                                });
                            else 
                                $(this).attr(&#x27;unselectable&#x27;, &#x27;on&#x27;);
                });
            }
            else {
                return this.each(function(){
                    if ($.browser.msie || $.browser.safari) 
                        $(this).unbind(&#x27;selectstart&#x27;);
                    else 
                        if ($.browser.mozilla) 
                            $(this).css(&#x27;MozUserSelect&#x27;, &#x27;inherit&#x27;);
                        else 
                            if ($.browser.opera) 
                                $(this).unbind(&#x27;mousedown&#x27;);
                            else 
                                $(this).removeAttr(&#x27;unselectable&#x27;, &#x27;on&#x27;);
                });
            }
        }
    }
    S.bridgeTojQuery(&quot;selectable&quot;, Selectable);
    
    return Selectable;
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<div class="foot">
		The API build by YUIDOC
		Simple UI is released under MIT License and implements open technologies such as:HTML5,CSS3,JavaScript.
		<p>
		如果你想为SimpleUI贡献代码，请点击这里<a target="_blank" href="http://github.com/simpleui">SimpleUI At Github</a>
		</p>
        <div class="blog-info">
         WordPress和<a href="http://simpleui.org" target="_blank">SimpleUI</a>强力驱动--蓝面小生--2012
		 <script src="http://s9.cnzz.com/stat.php?id=4424795&web_id=4424795&show=pic1" language="JavaScript"></script>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
